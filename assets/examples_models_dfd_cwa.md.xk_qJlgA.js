import{_ as t,c as r,o,a2 as i}from"./chunks/framework.DDIT__tB.js";const p=JSON.parse('{"title":"üìä Diagram: Corona Warn App (CWA)","description":"","frontmatter":{},"headers":[],"relativePath":"examples/models/dfd/cwa.md","filePath":"examples/models/dfd/cwa.md"}'),a={name:"examples/models/dfd/cwa.md"};function n(s,e,l,h,d,g){return o(),r("div",null,e[0]||(e[0]=[i('<h1 id="üìä-diagram-corona-warn-app-cwa" tabindex="-1">üìä Diagram: Corona Warn App (CWA) <a class="header-anchor" href="#üìä-diagram-corona-warn-app-cwa" aria-label="Permalink to &quot;üìä Diagram: Corona Warn App (CWA)&quot;">‚Äã</a></h1><h2 id="üîó-link-to-original-paper-article" tabindex="-1">üîó Link to Original Paper/Article <a class="header-anchor" href="#üîó-link-to-original-paper-article" aria-label="Permalink to &quot;üîó Link to Original Paper/Article&quot;">‚Äã</a></h2><p><a href="https://github.com/corona-warn-app/cwa-documentation/blob/main/solution_architecture.md" target="_blank" rel="noreferrer">View Full Main Source</a></p><h2 id="üìù-short-description" tabindex="-1">üìù Short Description <a class="header-anchor" href="#üìù-short-description" aria-label="Permalink to &quot;üìù Short Description&quot;">‚Äã</a></h2><p>This diagram illustrates the complex data flow of the Corona-Warn-App (CWA), as stated in their documentation. The architecture is divided into three main components: <strong>Corona-Warn-App</strong>, <strong>Verification Server</strong> and <strong>Corona-Warn-App Server</strong>. The first one runs on the user&#39;s mobile phone. This component is responsible for scanning nearby users&#39; keys via <em>Bluetooth Low Energy (BLE)</em>, interacting with the <em>Exposure Notification Framework</em>, and communicating with the <em>Data Donation Server</em>. The second one verifies test results received from the <em>Test Result Server</em>. The last one receives diagnosis keys from the CWA and analytics data from the <em>Data Donation Server</em>. It stores this data and, via the <em>Content Delivery Network (CDN)</em>, makes it available to other users, allowing them to determine whether they have been in contact with someone who tested positive.</p><h2 id="üî§-abbreviations" tabindex="-1">üî§ Abbreviations <a class="header-anchor" href="#üî§-abbreviations" aria-label="Permalink to &quot;üî§ Abbreviations&quot;">‚Äã</a></h2><ul><li>TEK: Temporary Exposure Key</li><li>RPI: Rolling Proximity Identifier</li><li>AEM: Associated Encrypted Metadata</li><li>TAN: Transaction Authorization Number</li><li>RAT: Rapid Antigen Test</li><li>EDUS: Event-Driven User Survey Service</li><li>PPA: Privacy-Preserving Analytics</li><li>OTC: Open Telekom Cloud</li><li>BLE: Bluetooth Low Energy</li></ul><h2 id="üìñ-extensive-description-if-possible" tabindex="-1">üìñ Extensive Description (if possible) <a class="header-anchor" href="#üìñ-extensive-description-if-possible" aria-label="Permalink to &quot;üìñ Extensive Description (if possible)&quot;">‚Äã</a></h2><p>The diagram can be divided into different sections. The first one, in the upper-right part of the diagram, is related to the <strong>CWA Data Donation Server Interface</strong>, in which depending on the users mobile phone OS a certain data flow is followed. For example in the case of an Android OS, the <strong>Google Service</strong> node generates an <em>attestation_token</em> which flows to the <strong>Google Attestation API</strong>. From this node the <em>attestation_token</em> is forwarded to the <strong>Send Attestation Token</strong> node which sends the token to the <strong>Send PPA</strong> and <strong>Send OTP for EDUS</strong>, which are the two framewroks for collecting data. In addition to the <em>attestation_token</em> these nodes also receive <em>salt</em> from the <strong>Generate Salt</strong> node (and forwarded by <strong>Send Salt</strong> node) which is added to the token for security reasons. In the case of Apples OS the main idea is simmilar but with other nodes and functions. From the PPA and EDUS nodes the <em>ppa</em> data and the respective EDUS tokens finally flow to the <strong>CWA Data Donation Server Interface</strong>. From this point on, again depending on the OS, there is some verification/checking of the sent tokens, but most importantly the connection to the <strong>Corona Warn App Server</strong>. This connection is done through the <strong>Analytic Data Storage</strong> which receives the <em>analytic_data</em> from the <strong>CWA Data Donation Server Interface</strong> and forwards it to the <strong>Generate Statistics</strong> node, which itself forwards this data to the C__Corona Warn App Server__.</p><p>The central (including left) part of the diagram focuses on the main data flows for the main tasks of CWA belonging to the test results functionality, creating/receiving the different identifiers for the user regarding their status. Here the most important nodes are the <strong>Test Result Server</strong>, which is responsible for receiving and transmitting the results from the <strong>Laboratory Information System</strong> and forwarding them to the <strong>Verification Server</strong>. This server receives the pcr test results, RAT test results which can be directly uploaded by the user and the TAN identifier and forwards them to the <strong>Corona Warn App</strong> (the test results) and the <strong>Health Authority Portal</strong> (the teleTAN) and the <strong>Upload Keys</strong> (normal TAN) nodes. The <strong>Corona Warn App</strong> is mainly responsible for sending th ekeys which reflect the users state, evaluating the risk of the user given his/her encounter with other (possibly infected) users.</p><p>Finally the right-most side of the diagram shows the process of the distribution of the keys generated by the user thorugh the <strong>Exposure Notification Framework</strong>, which is the joint API/framework by Google and Apple that all national apps are built on. This node is responsible for: Receiving the RPIs via the <strong>BLE Interface</strong> and sending the identifier through the <strong>Send Bluetooth Payload</strong>. Logging the foreign RPIs, their storage in <strong>Foreign RPIs Storage</strong> node and their later comparison in the <strong>Compare Keys</strong> node to create a risk summary for the user.</p><p>A further and deeper understanding of the different components can be studied in their documentation (link above).</p><h2 id="üè∑Ô∏è-label-description" tabindex="-1">üè∑Ô∏è Label description <a class="header-anchor" href="#üè∑Ô∏è-label-description" aria-label="Permalink to &quot;üè∑Ô∏è Label description&quot;">‚Äã</a></h2><ul><li><h3 id="üóÇÔ∏è-data-labels" tabindex="-1">üóÇÔ∏è Data Labels: <a class="header-anchor" href="#üóÇÔ∏è-data-labels" aria-label="Permalink to &quot;üóÇÔ∏è Data Labels:&quot;">‚Äã</a></h3><ul><li><h3 id="identifiers" tabindex="-1">Identifiers: <a class="header-anchor" href="#identifiers" aria-label="Permalink to &quot;Identifiers:&quot;">‚Äã</a></h3><ul><li><strong>GuidQR</strong>: QR for the test results</li><li><strong>PersonalData</strong>: Personal data from the tested patient</li><li><strong>CWATestId</strong>: Test ID from the Corona Warn App</li><li><strong>RPI</strong>: A short-lived identifier derived from the TEK (changes every ~10‚Äì20 minutes). These are what phones actually broadcast via Bluetooth.</li><li><strong>TEK</strong>: A secret key generated once per day on your phone. It never leaves your device except when you report a positive test.</li><li><strong>AEM</strong>: Extra information sent together with the RPI over Bluetooth</li></ul></li><li><h3 id="tokens" tabindex="-1">Tokens: <a class="header-anchor" href="#tokens" aria-label="Permalink to &quot;Tokens:&quot;">‚Äã</a></h3><ul><li><strong>RegistrationToken</strong>: Registration for the app</li><li><strong>TAN</strong>: A one-time code you get (e.g., via hotline or test result portal) that authorizes your app to upload your TEKs if you tested positive.</li><li><strong>DiagnosisKeys</strong>: These are simply the TEKs from the days you were infectious that you upload</li><li><strong>TeleTAN</strong>: A TAN given verbally by phone (via hotline) when your test result cannot automatically trigger a normal TAN</li><li><strong>DiagnosisKeyBatch</strong>: Batch of Diagnosis Keys</li><li><strong>AttestationToken</strong>: A cryptographic proof issued by the Google/Apple Exposure Notification (GAEN) framework.</li><li><strong>APIToken</strong>: In Corona-Warn-App, this is a temporary token from the CWA server that the app uses to prove it already passed the TAN validation step.</li><li><strong>OTP</strong>: A short-lived code used once in the verification process (e.g., during TAN/TeleTAN exchange). It prevents replay attacks when requesting tokens.</li><li><strong>DeviceToken</strong>: A persistent identifier assigned per device to prevent abuse of the verification system (e.g., requesting too many TANs).</li><li><strong>Salt</strong>: A random value added when hashing data (e.g., during device token creation) to ensure uniqueness and resist pre-computation attacks</li></ul></li><li><h3 id="testresults" tabindex="-1">TestResults: <a class="header-anchor" href="#testresults" aria-label="Permalink to &quot;TestResults:&quot;">‚Äã</a></h3><ul><li><strong>PCRTestResultsPositive</strong>: PCR positive test results</li><li><strong>RATTestResults</strong>: Results of the RAT test</li></ul></li><li><h3 id="userconfigurations" tabindex="-1">UserConfigurations: <a class="header-anchor" href="#userconfigurations" aria-label="Permalink to &quot;UserConfigurations:&quot;">‚Äã</a></h3><ul><li><strong>NotificationsOn</strong>: User allows to receive notifications from the app</li><li><strong>AllowUploadKeys</strong>: User allows the app to upload its keys</li><li><strong>AllowPersonalData</strong>: user allows the app to use its personal data</li></ul></li><li><h3 id="encrypted" tabindex="-1">Encrypted: <a class="header-anchor" href="#encrypted" aria-label="Permalink to &quot;Encrypted:&quot;">‚Äã</a></h3><ul><li><strong>Metadata</strong>: Metadata sent from the app</li></ul></li><li><h3 id="information" tabindex="-1">Information: <a class="header-anchor" href="#information" aria-label="Permalink to &quot;Information:&quot;">‚Äã</a></h3><ul><li><strong>RiskSummary</strong>: Summary of potential risk for the user based on the received keys from other users</li><li><strong>APIsMetadata</strong>: Metadata from the APIs</li><li><strong>EDUS</strong>: Token for EDUS (backend-service for collecting data surveys from users)</li><li><strong>PPA</strong>: Same as previous but for PPA (for collecting app usage statistics in a privacy-preserving way)</li><li><strong>AnalyticData</strong>: Analytic data from the users to generate statistics</li><li><strong>SurveyData</strong>: Data from the survey of the users</li></ul></li><li><h3 id="diagnosiskeys" tabindex="-1">DiagnosisKeys: <a class="header-anchor" href="#diagnosiskeys" aria-label="Permalink to &quot;DiagnosisKeys:&quot;">‚Äã</a></h3><ul><li><strong>Local</strong>: Diagnosis Keys from within germany</li><li><strong>Foreign</strong>: Diagnosis Keys from other countries (normally within the UE)</li></ul></li></ul></li><li><h3 id="üè∑Ô∏è-node-labels" tabindex="-1">üè∑Ô∏è Node Labels: <a class="header-anchor" href="#üè∑Ô∏è-node-labels" aria-label="Permalink to &quot;üè∑Ô∏è Node Labels:&quot;">‚Äã</a></h3><ul><li><h3 id="mobileos" tabindex="-1">MobileOS: <a class="header-anchor" href="#mobileos" aria-label="Permalink to &quot;MobileOS:&quot;">‚Äã</a></h3><ul><li><strong>IOS</strong>: Apple Operating System</li><li><strong>Android</strong>: Androids Operating System</li></ul></li><li><h3 id="server" tabindex="-1">Server: <a class="header-anchor" href="#server" aria-label="Permalink to &quot;Server:&quot;">‚Äã</a></h3><ul><li><strong>CWApp</strong>: Corona Warn App in the users mobile phone</li><li><strong>CWAppServer</strong>: Corona Warn App central servers</li><li><strong>VerificationServer</strong>: Server where the test results are verified</li><li><strong>DDServer</strong>: Diagnosis Data Server</li><li><strong>AppleServer</strong>: Server from Apple for managing their API</li><li><strong>Androiderver</strong>: Server from Android for managing their API</li><li><strong>TestResultServer</strong>: Server for managing the test results coming from the laboratory</li><li><strong>ForeignCountryServer</strong>: Server for the Covid app from a foreign country</li><li><strong>SurveyBrowser</strong>: Browser where the survey takes place</li><li><strong>SurverySystemEDUS</strong>: Survey System for the EDUS</li><li><strong>GoogleServer</strong>: Googles server for the Attestation API</li></ul></li><li><h3 id="cloud" tabindex="-1">Cloud: <a class="header-anchor" href="#cloud" aria-label="Permalink to &quot;Cloud:&quot;">‚Äã</a></h3><p>-<strong>OTC</strong>: Hosting environment in the cloud for the CWApp backend</p></li></ul></li></ul><h2 id="‚ö†Ô∏è-constraints" tabindex="-1">‚ö†Ô∏è Constraints <a class="header-anchor" href="#‚ö†Ô∏è-constraints" aria-label="Permalink to &quot;‚ö†Ô∏è Constraints&quot;">‚Äã</a></h2><ul><li><p>RPI and TEK identifiers may never flow to the CWA or CWA Server for privacy reasons:</p><ol><li><strong>RPIs_TEKs</strong>: <code>data Identifiers.RPI,Identifiers.TEK neverFlows vertex Server.CWApp,Server.CWAppServer</code></li></ol></li><li><p>Personal data shuld never flow to the CWA (in the mobile phone), Verification server, Test Results Server, DD server and CWA server.</p><ol start="2"><li><strong>Personal_Data</strong>: <code>data Identifiers.PersonalData neverFlows vertex Server.CWApp,Server.VerificationServer,Server.TestResultServer,Server.DDServer,Server.CWAppServer</code></li></ol></li></ul><h2 id="üö®-violations" tabindex="-1">üö® Violations <a class="header-anchor" href="#üö®-violations" aria-label="Permalink to &quot;üö® Violations&quot;">‚Äã</a></h2><p>Although no violations were found in the original CWA architecture, we have slightly modified the diagram to produce two alternate versions in which violations are introduced:</p><ul><li><p>The first diagram, <strong>RPIViolation</strong>, illustrates a breach in which <strong>RPIs (Rolling Proximity Identifiers)</strong> flow into the CWA Server. This is a clear violation, as RPIs could potentially be linked back to individuals, undermining the anonymity and privacy principles of the original CWA.</p><ol><li><code>data Identifiers.RPI neverFlows vertex Server.CWAppServer</code></li></ol></li><li><p>The second diagram, <strong>PersonalDataViolation</strong>, shows a case where <strong>personal data</strong> from the user&#39;s mobile device flows into the CWA (via the Verification Server). This is another violation of the strict privacy guarantees provided by the real CWA.</p><ol start="2"><li><code>data Identifiers.PersonalData neverFlows vertex Server.CWApp,Server.VerificationServer,Server.TestResultServer,Server.DDServer,Server.CWAppServer</code></li></ol></li></ul>',19)]))}const u=t(a,[["render",n]]);export{p as __pageData,u as default};
