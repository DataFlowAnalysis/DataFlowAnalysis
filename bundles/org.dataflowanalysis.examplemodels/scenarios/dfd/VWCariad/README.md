# üìä Diagram: Volkswagen-Cariad Automotive System

## üîó Link to Original Paper/Article
[View Full Main Source](<https://www.spiegel.de/netzwelt/web/volkswagen-konzern-datenleck-wir-wissen-wo-dein-auto-steht-a-e12d33d0-97bc-493c-96d1-aa5892861027>)

## üìù Short Description
This diagram illustrates the issues associated with the Volkswagen (and Cariad) scandal and data leakage affecting their automobile fleet. It shows how information flows between the mobile app, internal servers (and storage), and the in-vehicle system.
The first (leftmost) section of the diagram presents a simplified data flow from the mobile app, including functionalities such as login, retrieving the car's location, locking the car, and more. This part connects to Cariad‚Äôs main Spring application, which is primarily responsible for storing all vehicle-related data. Finally, on the right side of the diagram, we see the in-car system, composed of sensors, actuators, controllers, control modules, and communication components.

This DFD represents what we think the architecture of the system should look like, as this is private company information we have inferred the different sections of the diagram from information mentioned on the main source article, the Spring documentation and other resources regarding the inner functioning of car systems.

## üî§ Abbreviations
- ECU: Electronic Control Unit


## üìñ Extensive Description (if possible)
Starting from the left side of the diagram there is the authentication process for a __Customer__ which want to be identified in the VWs Mobile App for accessing different functionalities of its car remotely. This can be seen through the __Mobile App UI__ nod and the corresponding function nodes such as __Start AC__, __Get Car Location__, etc.

From those functionalities, the given commands to be executed on the car flow in to the Spring App through the __Spring Security__ node which verifies the secureness of those commands, and in case there is something wrong (e.g. wrong credentials) it send a *security_event* to the __Spring Actuator__ node. This central part of the diagram shows the main functionality of the VW-Cariads system. For our case study regarding the scandal the most important nodes are __Spring Web Controller__, __Spring Actuator__, and __Spring App Memory__. The first one manages the request (e.g. from the mobile app) and forwards them to the __Spring Actuator__. This second one then forwards the requests to the defined endpoints (e.g. __Aditevent Repository__, __Http Trace Endpoint__, etc). The last one (__Spring App Memory__) loads the memory of the spring app into the endpoint __Heapdump__ (which was the central point of the scandal as it had __public__ access).

Finally the left-most part shows the inner components of the car such as the __High Perfomance Computer__ which receives the commands from the app and forwards them to the __Vehicle Communication Bus__ and finally to their respective components (e.g. __Navigation ECU__, __Body Control Module__, etc). The __High Performance Computer__ also manages the retrieving and storing of data from the car sensors and sends them to the Spring App through the __Azure event Grid__.

## üè∑Ô∏è Label description

- ### üóÇÔ∏è Data Labels:
    - ### DataEncryption:
        - __NonEncrypted__: Non-encrypted data
        - __Encrypted__: Encrypted data
    
    - ### DataSensitivity:
        - __Personal__: Data that is personal
        - __Anonymized__: Data that is anonymized
        - __NonAnonymized__: Data that is not anonymized
        - __Confidential__: Data that is confidential
    
    - ### UserClearance:
        - __Authenticated__: User has been correctly authenticated
        - __NonAuthenticated__: User has not been correctly authenticated

    - ### DataBaseToken:
        - __AzureToken__: Token to access Azure DB
        - __AWSToken__: Token to access AWS DB (S3 bucket)
    
    - ### SecurityEvent:
        - __SecurityEvent__: Security Event information generated by the Flask app

    - ### RequestSensitivity:
        - __Confidential__: The request is confidential (or for confidential information)
        - __Public__: The request is public
    
    - ### Credentials:
        - __Valid__: Credentials are valid (after being checked)
        - __NonValid__: Credentials are not valid

- ### üè∑Ô∏è Node Labels:
    - ### EndpointConfiguration:
        - __Private__: Endpoint is private and can only be accessed by certain members of the company
        - __Public__: Endpoint is public and can be accessed by anyone
        - __SpringMemory__: The endpoint is the Spring App Memory
    
    - ### DataBaseType:
        - __AzureDataLake__: DB is from Azure
        - __AWSBucket__: DB is from AWS

    - ### CarControlUnits:
        - __ECU__: Electronic Control Unit of the car for a given component of the car

## ‚ö†Ô∏è Constraints
- Data which is classified as condifential can neverflow to an endpoint which is public:

    1. __confidential_data__: `data DataSensitivity.Confidential neverFlows vertex EndpointConfiguration.Public`

- Data which is not anonymized, and thus contains sensitive information about customers and their routes with their cars, should never flow to either data base types

    2. __anonymized_db__: `data DataSensitivity.NonAnonymized neverFlows vertex DataBaseType.AWSBucket,DataBaseType.AzureDataLake`

- Requests which are confidential can never flow to endpoints that are public

    3. __confidential_request__: `data RequestSensitivity.Confidential neverFlows vertex EndpointConfiguration.Public`

- DB credentials should neverflow to an endpoint which is public:

    4. __credentials_public__: `data DataBaseToken.AWSToken,DataBaseToken.AzureToken neverFlows vertex EndpointConfiguration.Public`


- Data which is not encrypted should never flow to either database types:

    5. __encrypted_data__: `data DataEncryption.NonEncrypted neverFlows vertex DataBaseType.AWSBucket,DataBaseType.AzureDataLake`

- A user whose authentication has not been cleared should never flow to a Car Control Unit:

    6. __authenticated_command__: `data UserClearance.NonAuthenticated neverFlows vertex CarControlUnits.ECU`

## üö® Violations
The following violations relate to the issues revealed in the scandal referenced in the previous article (among others). These have been added to the diagram to highlight what went wrong. 

- The following violated constraints show that not only was the **heapdump** endpoint relatively easy to access, but it also exposed confidential and highly sensitive information (e.g., tokens for accessing databases):

    1. __confidential_data__
    3. __confidential_request__
    4. __credentials_public__

- The next set of violations corresponds to another issue in the scandal: the presence of non-anonymized and unencrypted data in the AWS bucket:

    2. __anonymized_db__
    5. __encrypted_data__

















